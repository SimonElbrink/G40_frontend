<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    
    <!--https://www.bootstrapcdn.com/-->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css" integrity="sha384-1BmE4kWBq78iYhFldvKuhfTAU6auU8tT94WrHftjDbrCEXSU1oBoqyl2QvZ6jIW3" crossorigin="anonymous">
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/js/bootstrap.min.js" integrity="sha384-QJHtvGhmr9XOIpI6YVutG+2QOK9T+ZnN4kzFN1RtK3zEFEIsxhlmWl5/YESvpZ13" crossorigin="anonymous"></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/js/bootstrap.bundle.min.js" integrity="sha384-ka7Sk0Gln4gmtz2MlQnikT1wXgYsOg+OMhuP+IlRH9sENBO0LRn5q+8nbTov4+1p" crossorigin="anonymous"></script>

    <title>Practice</title>
</head>
<body onload="displayData()">
    <div class="container mt-5">
        <div id="message"></div>
        <div class="card">
            <div class="card-header bg-dark text-white">Show Data</div>
            <div id="data" class="card-body">
                <table id="dataTable" class="table table-striped">
                    <thead>
                        <tr>
                            <th>Id</th>
                            <th>Name</th>
                            <th>BirthDate</th>
                        </tr>
                    </thead>

                    <tbody id="personTableBody"></tbody>

                </table>
            </div>
        </div>
        <hr/>
        <div class="card">
            <div class="card-header bg-info text-white">Register Form</div>
            <div class="card-body">
                <form name="myForm" class="form-control">
                    <div class="row">
                        <div class="col-6">
                            <input type="text" class="form-control" id="name" name="name" placeholder="Enter Name" />
                        </div>
                        <div class="col-4">
                            <input type="text" class="form-control" id="birthDate" name="birthDate" placeholder="Enter BirthDate" />
                        </div>
                        <div class="col-2">
                            <button type="button" class="btn btn-success" onclick="addPerson()">Click Me</button>
                            <script>
                                const persons = [
                                    {id: 1200, name: "Simon", birthDate: "1990-01-01"}
                                ];
                              
                                function addPerson() {
                                   // todo: implement add person function
                                   // create a random value for id property

                                   const id = Math.floor(Math.random() * 10000000);
                                   const name = document.getElementById("name").value;
                                   const birthDate = document.getElementById("birthDate").value;

                                   const newPerson = {id, name, birthDate};

                                   persons.push(newPerson);

                                   console.log(persons);

                                   //re-create the table body with newly adde elements.
                                   displayData();

                                }

                                function deletePerson(id) {
                                   //todo: find the person by id from the list then remove it
                                   alert("Removing! person with ID:" + id);

                                   const foundPersonIndex = persons.findIndex(element => element.id === id);

                                   console.log(foundPersonIndex);

                                    persons.splice(foundPersonIndex, 1);

                                    //re-create the table body with newly adde elements.
                                   displayData();

                                }

                                function displayData(){     
                                     //todo: implement a string template for creating the table rows using <tr> and <td> with person propeties 
                                    
                                    const tableRows = persons.map((person) => {
                                            const row = `
                                            <tr id="${person.id}">
                                                <td>${person.id}</td>
                                                <td>${person.name}</td>
                                                <td>${person.birthDate}</td>
                                                <td><button type="button" class="btn btn-danger" onclick="deletePerson(${person.id})">X</button></td>
                                            </tr>`;

                                            return row;
                                });

                                const tbody = document.getElementById("personTableBody");

                                tbody.innerHTML = tableRows.join("");
                                }
                            </script>
                        </div>
                    </div>
                </form>
            </div>
        </div>
    </div>
    
</body>
</html>